<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü–∞–Ω–µ–ª—å —É—á–µ–Ω–∏–∫–∞</title>
    <link rel="stylesheet" href="/css/site.css">
</head>
<body>
<header>
    <h1>Electronic Diary</h1>
    <nav>
        <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
        <form method="post" action="/logout" style="display: inline;">
            <button type="submit" class="button-link" style="background: none; border: none; color: #e2e8f0; cursor: pointer; font-size: 1em; padding: 0; margin-left: 16px;">–í—ã–π—Ç–∏</button>
        </form>
    </nav>
</header>
<main>
    <section class="card">
        <h2>–ü–∞–Ω–µ–ª—å —É—á–µ–Ω–∏–∫–∞</h2>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —É—á–µ–Ω–∏–∫–∞.</p>
    </section>

    <section class="card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3 style="margin: 0;">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h3>
            <a class="button" href="/schedule">–ü–æ–ª–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</a>
        </div>
        <div id="schedule-container" class="schedule-grid">
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...</p>
        </div>
    </section>
</main>
<script src="/js/navigation.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const schoolName = window.location.pathname.split('/')[1];
        const container = document.getElementById("schedule-container");

        fetch(`/api/${schoolName}/schedules/my/today`)
            .then(response => response.json())
            .then(schedule => {
                container.innerHTML = "";
                if (schedule.length === 0) {
                    container.innerHTML = "<p style='font-size: 1.2em; color: #10b981; text-align: center; width: 100%;'>–°–µ–≥–æ–¥–Ω—è –æ—Ç–¥—ã—Ö–∞–µ—Ç–µ! üéâ</p>";
                    return;
                }

                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞
                schedule.sort((a, b) => a.startTime.localeCompare(b.startTime));

                schedule.forEach(item => {
                    const div = document.createElement("div");
                    div.className = "schedule-item";
                    div.innerHTML = `
                        <div class="schedule-time">${item.startTime} - ${item.endTime}</div>
                        <div class="schedule-subject">${item.disciplineName}</div>
                        <div class="schedule-details">
                            –ö–∞–±. ${item.classroom || "‚Äî"}<br>
                            ${item.teacherName}
                        </div>
                    `;
                    container.appendChild(div);
                });
            })
            .catch(error => {
                console.error("Error loading schedule:", error);
                container.innerHTML = "<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.</p>";
            });
    });
</script>
</body>
</html>
